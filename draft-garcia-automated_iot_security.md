---
abbrev: Automated IoT Security
title: Automated IoT Security 
cat: info
stand_alone: true
informative:
  ID-dietesp:
    title: "Diet-ESP: a flexible and compressed format for IPsec/ESP"
    author:
    - ins: D. Migault
    - ins: T. Guggemos
    - ins: C. Bormann
    date: 2016-08
    seriesinfo:
       draft-mglt-6lo-diet-esp-02
  ID-senml:
    title: "Media Types for Sensor Measurement Lists (SenML)"
    author:
    - ins: C. Jennings
    - ins: Z. Shelby
    - ins: J. Arkko
    - ins: A. Keranen
    - ins: C. Bormann
    date: 2016-10
    seriesinfo:
      draft-ietf-core-resource-directory-09
  ID-rd:
    title: "CoRE Resource Directory"
    author:
    - ins: Z. Shelby
    - ins: M. Koster
    - ins: C. Bormann
    - ins: P. Stok
    date: 2016-10
    seriesinfo:
      draft-ietf-core-resource-directory-09
  ID-cose:
    title: "CBOR Object Signing and Encryption (COSE)"
    author:
    - ins: J. Schaad
    date: 2016-11
    seriesinfo:
      draft-ietf-cose-msg-24
  ID-6lodect:
    title: "Transmission of IPv6 Packets over DECT Ultra Low Energy"
    author:
    - ins: P. Mariager
    - ins: J. Petersen
    - ins: Z. Shelby
    - ins: M. Logt
    - ins: D. Barthel
    date: 2016-12
    seriesinfo:
      draft-ietf-6lo-dect-ule-09
  ID-6lonfc:
    title: "Transmission of IPv6 Packets over Near Field Communication"
    author:
    - ins: Y. Choi
    - ins: Y. Hong
    - ins: J. Youn
    - ins: D. Kim
    - ins: J. Choi
    date: 2016-10
    seriesinfo:
      draft-ietf-6lo-nfc-05  
  ID-6tisch:
    title: "An Architecture for IPv6 over the TSCH mode of IEEE 802.15.4"
    author:
    - ins: P. Thubert
    date: 2017-01
    seriesinfo:
      draft-ietf-6tisch-architecture-11  
  ID-aceoauth:
    title: Authentication and Authorization for Constrained Environments (ACE)
    author:
    - ins: L. Seitz
    - ins: G. Selander
    - ins: E. Wahlstroem
    - ins: S. Erdtman
    - ins: H. Tschofenig
    date: 2011-03
    seriesinfo:
      draft-ietf-ace-oauth-authz-05
  ID-Daniel:
    title: IPv6 over Low Power WPAN Security Analysis
    author:
    - ins: S. Park
    - ins: K. Kim
    - ins: W. Haddad
    - ins: S. Chakrabarti
    - ins: J. Laganier
    date: 2011-03
    seriesinfo:
      draft-daniel-6lowpan-security-analysis-05
  ID-HIP:
    title: HIP Diet EXchange (DEX)
    author:
    - ins: R. Moskowitz
    date: 2012-05
    seriesinfo:
      draft-moskowitz-hip-rg-dex-06
  ID-Hartke:
    title: Datagram Transport Layer Security in Constrained Environments
    author:
    - ins: K. Hartke
    - ins: O. Bergmann
    date: 2012-07
    seriesinfo:
      draft-hartke-core-codtls-02
  RFC7401:
  ID-Nikander:
    title: A Bound End-to-End Tunnel(BEET) mode for ESP
    author:
    - ins: P. Nikander
    - ins: J. Melen
    date: 2008-08
    seriesinfo:
      draft-nikander-esp-beet-mode-09
  ID-OFlynn:
    title: Security Bootstrapping of Resource-Constrained Devices
    author:
    - ins: C. O'Flynn
    - ins: B. Sarikaya
    - ins: Y. Ohba
    - ins: Z. Cao
    - ins: R. Cragie
    date: 2010-11
    seriesinfo:
      draft-oflynn-core-bootstrapping-03
  ID-Tsao:
    title: A Security Framework for Routing over Low Power and Lossy Networks
    author:
    - ins: T. Tsao
    - ins: R. Alexander
    - ins: M. Dohler
    - ins: V. Daza
    - ins: A. Lozano
    date: 2012-01
    seriesinfo:
      draft-ietf-roll-security-framework-07
  ID-Moore:
    title: Best Current Practices for Securing Internet of Things (IoT) Devices
    author:
    - ins: K. Moore
    - ins: R. Barnes
    - ins: H. Tschofenig
    date: 2016-10
    seriesinfo:
      draft-moore-iot-security-bcp-00
  ID-MUD:
    title: Manufacturer Usage Description Specification
    author:
    - ins: E. Lear
    - ins: R. Droms
    - ins: D. Domascanu
    date: 2017-03
    seriesinfo:
  ID-Williams:
    title: Mobile DTLS
    author:
    - ins: M. Williams
    - ins: J. Barrett
    date: 2009-03
    seriesinfo:
      draft-barrett-mobile-dtls-00
  ID-proHTTPCoAP:
    title: Best practices for HTTP-CoAP mapping implementation
    author:
    - ins: A. Castellani
    - ins: S. Loreto
    - ins: A. Rahman
    - ins: T. Fossati
    - ins: E. Dijk
    date: 2013-02
    seriesinfo:
      draft-castellani-core-http-mapping-07
  ID-OSCOAP:
    title: Object Security of CoAP (OSCOAP)
    author:
    - ins: G. Selander
    - ins: J. Mattsson
    - ins: F. Palombini
    - ins: L. Seitz    
    date: 2016-07    
    seriesinfo:
      draft-selander-ace-object-security-05  
  ENISA_ICS:
    title: "Communication network dependencies for ICS/SCADA Systems"
    date: 2017-02
    seriesinfo: European Union Agency For Network And Information Security
  ID-bootstrap:
    title: "Secure IoT Bootstrapping : A Survey"
    author:
    - ins: B. Sarikaya
    - ins: M. Sethi
    date: 2016-07
    seriesinfo:
      draft-sarikaya-t2trg-sbootstrapping-01
  RFC2119:
  RFC2818: 
  RFC3261: 
  RFC3748: 
  RFC3756: 
  RFC3833: 
  RFC4016:  
  RFC4251: 
  RFC4555: 
  RFC4621: 
  RFC4738: 
  RFC4919: 
  RFC4944: 
  RFC5191: 
  RFC5206: 
  RFC5246:
  RFC5713: 
  RFC5903: 
  RFC6345: 
  RFC6347:
  RFC6550:
  RFC6551:
  RFC6568:
  RFC6690: 
  RFC6749:
  RFC7049:
  RFC7158:
  RFC7252:
  RFC7296:
  RFC7390:
  RFC7515:
  RFC7517:
  RFC7519:
  RFC7668:
  RFC7696:
  RFC7815:
  RFC7925: 
  AUTO-ID:
    title: AUTO-ID LABS
    date: 2010-09
    seriesinfo:
      Web: http://www.autoidlabs.org/
  BACNET:
    title: BACnet
    date: 2011-02
    seriesinfo:
      Web: http://www.bacnet.org/
  DALI:
    title: DALI
    date: 2011-02
    seriesinfo:
      Web: http://www.dalibydesign.us/dali.html
  JOURNAL-Perrig:
    title: 'SPINS: Security protocols for Sensor Networks'
    author:
    - ins: A. Perrig
    - ins: R. Szewczyk
    - ins: V. Wen
    - ins: D. Culler
    - ins: J. Tygar
    date: 2002-09
    seriesinfo:
      Journal: Wireless Networks
  NIST:
    title: NIST Specification Publication 800-38B
    author:
    - ins: M. Dworkin
    date: 2005
  SPEKE:
    title: 'IEEE P1363.2: Password-based Cryptography'
    date: 2008
  PROC-Chan:
    title: Random Key Predistribution Schemes for Sensor Networks
    author:
    - ins: H. Chan
    - ins: A. Perrig
    - ins: D. Song
    date: 2003
    seriesinfo:
      Proceedings: IEEE Symposium on Security and Privacy
  PROC-Gupta:
    title: 'Sizzle: A Standards-based End-to-End Security Architecture for the Embedded
      Internet'
    author:
    - ins: V. Gupta
    - ins: M. Wurm
    - ins: Y. Zhu
    - ins: M. Millard
    - ins: S. Fung
    - ins: N. Gura
    - ins: H. Eberle
    - ins: S. Shantz
    date: 2005
    seriesinfo:
      Proceedings: Pervasive Computing and Communications (PerCom)
  PROC-Smetters-02:
    title: 'Talking To Strangers: Authentication in Ad-Hoc Wireless Networks'
    author:
    - ins: D. Balfanz
    - ins: D. Smetters
    - ins: P. Steward
    - ins: H. Chi Wong,
    date: 2002
    seriesinfo:
      Paper: NDSS
  Ziegeldorf:
    title: 'Privacy in the Internet of Things: Threats and Challenges'
    author:
    - ins: J.H. Ziegeldorf
    - ins: O. Garcia-Morchon
    - ins: K. Wehrle,
    date: 2013
    seriesinfo:
      Paper: Security and Communication Networks - Special Issue on Security in a Completely Interconnected World
  d2dsecurity:
    title: 'Security and Privacy in Device-to-Device (D2D) Communication: A Review'
    author:
    - ins: M. Haus
    - ins: M. Waqas
    - ins: A. Ding
    - ins: Y. Li
    - ins: S. Tarkoma
    - ins: J. Ott
    date: 2016
    seriesinfo:
      Paper: IEEE Communications Surveys and Tutorials
  PROC-Smetters-04:
    title: 'Network-in-a-Box: How to Set Up a Secure Wireless Network in Under a Minute'
    author:
    - ins: D. Balfanz
    - ins: G. Durfee
    - ins: R. Grinter
    - ins: D. Smetters
    - ins: P. Steward
    date: 2004
    seriesinfo:
      Paper: USENIX
  PROC-Stajano-99:
    title: Resurrecting Duckling - Security Issues for Adhoc Wireless Networks
    author:
    - ins: F. Stajano
    - ins: R. Anderson
    date: 1999-11
    seriesinfo:
      7th: International Workshop Proceedings
  THESIS-Langheinrich:
    title: Personal Privacy in Ubiquitous Computing
    author:
    - ins: M. Langheinrich
    date: 2005
    seriesinfo:
      PhD: Thesis ETH Zurich
  TinyDTLS:
    title: TinyDTLS
    date: 2012-02
    seriesinfo:
      Web: http://tinydtls.sourceforge.net/
  WG-6LoWPAN:
    title: IETF 6LoWPAN Working Group
    date: 2011-02
    seriesinfo:
      Web: http://tools.ietf.org/wg/6lowpan/
  WG-CoRE:
    title: IETF Constrained RESTful Environment (CoRE) Working Group
    date: 2011-02
    seriesinfo:
      Web: https://datatracker.ietf.org/wg/core/charter/
  WG-LWIG:
    title: IETF Light-Weight Implementation Guidance (LWIG) Working Group
    date: 2011-03
    seriesinfo:
      Web: https://datatracker.ietf.org/wg/lwig/charter/   
  RG-T2TRG:
    title: IRTF Thing-to-Thing (T2TRG) Research Group
    date: 2015-12
    seriesinfo:
      Web: https://datatracker.ietf.org/rg/t2trg/charter/
  WG-ACE:
    title: IETF Authentication and Authorization for Constrained Environments (ACE) Working Group
    date: 2014-06
    seriesinfo:
      Web: https://datatracker.ietf.org/wg/ace/charter/
  WG-MSEC:
    title: MSEC Working Group
    seriesinfo:
      Web: http://datatracker.ietf.org/wg/msec/
  IEEE802ah:
    title: 'Status of Project IEEE 802.11ah, IEEE P802.11- Task Group AH-Meeting Update.'
    seriesinfo:
      Web: http://www.ieee802.org/11/Reports/tgah_update.htm      
  nbiot:
    title: 'NarrowBand IoT'
    seriesinfo:
      Web: http://www.3gpp.org/ftp/tsg_ran/TSG_RAN/TSGR_69/Docs/RP-151621.zip 
  lora:
    title: 'LoRa - Wide Area Networks for IoT'
    seriesinfo:
      Web: https://www.lora-alliance.org/     
  nist_lightweight_project:
    title: 'NIST lightweight Project'
    seriesinfo:
      Web: www.nist.gov/programs-projects/lightweight-cryptography, www.nist.gov/sites/default/files/documents/2016/10/17/sonmez-turan-presentation-lwc2016.pdf      
  sigfox:
    title: 'Sigfox - The Global Communications Service Provider for the Internet of Things (IoT)'
    seriesinfo:
      Web: https://www.sigfox.com/
  ZB:
    title: ZigBee Alliance
    date: 2011-02
    seriesinfo:
      Web: http://www.zigbee.org/
  Thread:
    title: Thread Group
    seriesinfo:
      Web: http://threadgroup.org/
  Fairhair:
    title: Fairhair Alliance
    seriesinfo:
      Web: https://www.fairhair-alliance.org/
  IIoT:
    title: Industrial Internet Consortium
    seriesinfo:
      Web: http://www.iiconsortium.org/      
  IPSO:
    title: IPSO Alliance
    seriesinfo:
      Web: http://www.ipso-alliance.org
  OneM2M:
    title: OneM2M
    seriesinfo:
      Web: http://www.onem2m.org/
  OCF:
    title: Open Connectivity Foundation
    seriesinfo:
      Web: https://openconnectivity.org/      
  NHTSA:
    title: Cybersecurity Best Practices for Modern Vehicles
    seriesinfo:
      Web: https://www.nhtsa.gov/staticfiles/nvs/pdf/812333_CybersecurityForModernVehicles.pdf     
  NIST-Guide:
    title: Systems Security Engineering
    author:
    - ins: R. Ross
    - ins: M. McEVILLEY
    - ins: J. C. Oren
    seriesinfo:
      Web: http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-160.pdf   
  DHS:
    title: Strategic Principles For Securing the Internet of Things (IoT)
    seriesinfo:
      Web: https://www.dhs.gov/sites/default/files/publications/Strategic_Principles_for_Securing_the_Internet_of_Things-2016-1115-FINAL....pdf   
  OWASP:
    title: IoT Security Guidance
    seriesinfo:
      Web: https://www.owasp.org/index.php/IoT_Security_Guidance     
  IoTSecFoundation:
    title: Establishing Principles for Internet of Things Security
    seriesinfo:
      Web: https://iotsecurityfoundation.org/establishing-principles-for-internet-of-things-security/           
  GSMAsecurity:
    title: GSMA IoT Security Guidelines
    seriesinfo:
      Web: http://www.gsma.com/connectedliving/future-iot-networks/iot-security-guidelines/
  BITAG:
    title: Internet of Things (IoT) Security and Privacy Recommendations
    seriesinfo:
      Web: http://www.bitag.org/report-internet-of-things-security-privacy-recommendations.php
  CSA:
    title: Security Guidance for Early Adopters of the Internet of Things (IoT)
    seriesinfo:
      Web: https://downloads.cloudsecurityalliance.org/whitepapers/Security_Guidance_for_Early_Adopters_of_the_Internet_of_Things.pdf      
  SchneierSecurity:
    title: The Internet of Things Is Wildly Insecure—And Often Unpatchable
    seriesinfo:
      Web: https://www.schneier.com/essays/archives/2014/01/the_internet_of_thin.html  
  FTCreport:
    title: FTC Report on Internet of Things Urges Companies to Adopt Best Practices to Address Consumer Privacy and Security Risks
    seriesinfo:
      Web: https://www.ftc.gov/news-events/press-releases/2015/01/ftc-report-internet-things-urges-companies-adopt-best-practices
  Article29:
    title: Opinion 8/2014 on the on Recent Developments on the Internet of Things
    seriesinfo:
      Web: http://ec.europa.eu/justice/data-protection/article-29/documentation/opinion-recommendation/files/2014/wp223_en.pdf 
  TR69:
    title: Too Many Cooks - Exploiting the Internet-of-TR-069-Things
    seriesinfo:
      Web: https://media.ccc.de/v/31c3_-_6166_-_en_-_saal_6_-_201412282145_-_too_many_cooks_-_exploiting_the_internet-of-tr-069-things_-_lior_oppenheim_-_shahar_tal 
  wink:
    title: Wink’s Outage Shows Us How Frustrating Smart Homes Could Be
    seriesinfo:
      Web: http://www.wired.com/2015/04/smart-home-headaches/  
  iotsu:
    title: "Patching the Internet of Things: IoT Software Update Workshop 2016"
    seriesinfo:
      Web: https://www.ietf.org/blog/2016/07/patching-the-internet-of-things-iot-software-update-workshop-2016/
  cctv:
    title: "Backdoor In MVPower DVR Firmware Sends CCTV Stills To an Email Address In China"
    seriesinfo:
      Web: https://hardware.slashdot.org/story/16/02/17/0422259/backdoor-in-mvpower-dvr-firmware-sends-cctv-stills-to-an-email-address-in-china   
  ETSI_GR_QSC_001:
    title: Quantum-Safe Cryptography (QSC);Quantum-safe algorithmic framework 
    date: 2016-06
    seriesinfo: European Telecommunications Standards Institute (ETSI)
  FCC:
    title: Federal Communications Comssion Response 12-05-2016 
    date: 12-02-2016 
    seriesinfo: FCC
 
author:
- name: Oscar Garcia-Morchon
  ins: O. Garcia-Morchon
  org: Philips IP&S
  street: High Tech Campus 5
  city: Eindhoven,   5656 AA
  country: The Netherlands
  email: oscar.garcia-morchon@philips.com
- name: Thorsten Dahm
  ins: T. Dahm
  org: Google
  street: todo
  city: Dublin
  country: Ireland
  email: thorstendlux@google.com
pi:
- toc
- sortrefs
- symrefs
- compact
- comments


--- abstract



The Internet of Things (IoT) concept refers to the usage of standard Internet protocols to allow for human-to-thing and thing-to-thing communication. 
The security needs are well-recognized and and many standardization steps for providing security have been taken, for example, the specification of Constrained Application Protocol (CoAP) over Datagram Transport Layer Security (DTLS). 
However, the design space of IoT applications and systems is complex and exposed to multiple types of threats.

This document summarizes key security threats and suitable mitigation strategies to protect against these threats and describes a comprehensive solution to integrate existing security processes such as risk asssement or vulnerability assessment in the lifecycle of a smart object in an IoT application.
To this end, we describe two protocols: the Protocol for Automatic Security Configuration (PASC) and the Protocol for Automatic Vulnerability Assessment (PAVA). 
PACS is executed during the onboarding phase of a smart object in an IoT system and is in charge of automatically assigning a security profile. The assigned security profile fits the specific environment and threat model of the application in which the device has been deployed. 
PAVA is executed during the operation of the IoT object and ensures that vulnerabilities in the smart object and IoT system are discovered in a proactive way. 
We describe a few examplary security profiles that could be applicable in different application areas.


--- middle

# Conventions and Terminology Used in this Document {#sec1}

The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD",
"SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to
be interpreted as described in "Key words for use in RFCs to Indicate Requirement
Levels" {{RFC2119}}.

# Introduction {#sec2}

The Internet of Things (IoT) denotes the interconnection of highly heterogeneous networked entities and networks following a number of communication patterns such as: human-to-human (H2H), human-to-thing (H2T), thing-to-thing (T2T), or thing-to-things (T2Ts). The term IoT was first coined by the Auto-ID center {{AUTO-ID}} in 1999. Since then, the development of the underlying concepts has ever increased its pace. Nowadays, the IoT presents a strong focus of research with various initiatives working on the (re)design, application, and usage of standard Internet technology in the IoT.

The IoT is exposed to a high number of attack vectors, that if sucessfully exploited by an attacker can have severe consequences.
Thus, this document firstly provides an overview of general threats.

Which mitigation strategies are most suitable to and required in an IoT system depends on several factors, including, the operational features of the IoT system or the threats that are applicable to that system.
Thus, this document further discusses processes that facilitate the proper design and operation of secure IoT systems, namely business impact analysis, risk assessment, privacy impact analysis, vulnerability analyis and incident reporting.
We further argue that even if these processes help IoT system designers to make secure products, a better approach would be to fully integrate these processes in the lifecycle of a smart object in an IoT application.
The reason is that IoT products are designed assuming a given environment and threat model that determines the require mitigation strategies. However, in practice, a IoT product can be deployed in very different environments and very different threat models.

Thus, in order to integrate security processes in the IoT lifecycle, we describe two protocols, the Protocol for Automatic Security Configuration (PACS) and the Protocol for Automatic Vulnerability Assessment (PAVA).
These two protocols allow us to integrate risk analysis, privacy impact analysis, and vulnerability assessments in the actual lifecycle of the smart objects so that smart objects can be configured with security profiles tailored to the very specific environment in which they are deployed.

Finally, this document describes diffent four exemplary security profiles, each comprising a set of threats, mitigation strategies, and configuration parameters,  that would be automatically applied to smart objects when joining different environments.

The rest of the Internet-Draft is organized as follows. 
Section {{sec3}} summarizes the design space of secure IoT systems, including lifecycle, device capabilities, and operational features. 
Section {{sec4}} discusses general threats that should be considered when designing and operating an IoT system. 
In Section {{sec5}}, general mitigation strategies to the identified threats are listed.
Choosing which mitigation strategies apply to which use cases is not trivial since it is required to find a proper balance between security, cost and usuability. 
Thus, Section {{sec6}} details methodologies for managing risks when designing a secure IoT system and dealing with vulnerabilities when operating the system. 
This section further describes how these methodologies can be integrated in the lifecycle of a smart object.
Section {{sec7}} proposes the Protocol for Automatic Security Configuration (PASC) that allows moving methodologies for risk  assessment and privacy impact analysis from the implementation to the onboarding phase of a device. 
This is enforced since each device discloses its operational requirements when joining an IoT system, and at this specific point of time, a security profile is applied to the device.
Section {{sec8}} describes the Protocol for Automatic Vulnerability Assessment (PAVA) that allows gathering information on potential vulnerabilities as detected by different devices so that vulnerabilities are detected and action can be taken, including the creation of incident reports delivered to the user and manufacturers. 
Section {{sec9}} describes how manufactures and users will benefit from PASC and PAVA when creating or using IoT systems.
Finally, {{sec10}} proposes a number of illustrative security profiles applicable to different illustrative clases of IoT systems. 
Each security profile comprises a set of mitigation strategies can provide a suitable security level and can be automatically deployed using PASC.
Section {{sec11}} includes final remarks and conclusions.



# The design space of secure IoT systems {#sec3}

TODO!!!!!!!!!!!!  write intro for this section whose goal is to describe 'general' aspects to consider when designing/operating/maintaining an IoT system.

## The Thing Lifecycle {#sec3-1}

The lifecycle of a thing refers to the operational phases of a thing in the context of a given application or use case. {{fig1}} shows the generic phases of the lifecycle of a thing. This generic lifecycle is applicable to very different IoT applications and scenarios.

We consider an example, a Building Automation and Control (BAC) system, to illustrate the lifecycle and the meaning of these different phases. 
A BAC system consists of a network of interconnected nodes that performs various functions in the domains of HVAC (Heating, Ventilating, and Air Conditioning), lighting, safety etc. The nodes vary in functionality and a majority of them represent resource constrained devices such as sensors and luminaries. Some devices may also be battery operated or battery-less nodes, demanding for a focus on low energy consumption and on sleeping devices.
In our example, the life of a thing starts when it is manufactured. Due to the different application areas (i.e., HVAC, lighting, safety) nodes are tailored to a specific task. It is therefore unlikely that one single manufacturer will create all nodes in a building. Hence, interoperability as well as trust bootstrapping between nodes of different vendors is important. The thing is later installed and commissioned within a network by an installer during the bootstrapping phase. Specifically, the device identity and the secret keys used during normal operation are provided to the device during this phase. Different subcontractors may install different IoT devices for different purposes. Furthermore, the installation and bootstrapping procedures may not be a defined event but may stretch over an extended period of time. After being bootstrapped, the device and the system of things are in operational mode and execute the functions of the BAC system. During this operational phase, the device is under the control of the system owner. For devices with lifetimes spanning several years, occasional maintenance cycles may be required. During each maintenance phase, the software on the device can be upgraded or applications running on the device can be reconfigured. The maintenance tasks can thereby be performed either locally or from a backend system by means of an end-to-end connection. Depending on the operational changes of the device, it may be required to re-bootstrap at the end of a maintenance cycle. The device continues to loop through the operational phase and the eventual maintenance phase until the device is decommissioned at the end of its lifecycle. However, the end-of-life of a device does not necessarily mean that it is defective but rather denotes a need to replace and upgrade the network to next-generation devices in order to provide additional  functionality. Therefore the device can be removed and re-commissioned to be used in a different system under a different owner by starting the lifecycle all over again. 

~~~~
 _Manufactured           _SW update          _Decommissioned
/                       /                   /
|   _Installed          |   _ Application   |   _Removed &
|  /                    |  / reconfigured   |  /  replaced
|  |   _Commissioned    |  |                |  |
|  |  /                 |  |                |  |   _Reownership &
|  |  |    _Application |  |   _Application |  |  / recommissioned
|  |  |   /   running   |  |  / running     |  |  |
|  |  |   |             |  |  |             |  |  |             \\
+##+##+###+#############+##+##+#############+##+##+##############>>>
    \/  \______________/ \/  \_____________/ \___/         time //
    /           /         \          \          \
Bootstrapping  /      Maintenance &   \     Maintenance &
              /      re-bootstrapping  \   re-bootstrapping
        Operational                Operational
~~~~
{: #fig1 title="The lifecycle of a thing in the Internet of Things."}


## Classifying IoT Use Cases {#sec3-2}

Next to the device lifecycle associated to an IoT use case, we can also further describe the IoT use case according to the five aspects below.

1. IoT system architecture: 

2. Device architecture:

3. Network: 

4. Application: 

## Some examplary use case {#sec3-3}


# Security Threats {#sec4}

Different use cases have different types of threats.
We can classify threats according to two criteria, what target of the threat is and when does the threat take place.
The target of the threat can be -- as described in {{sec3-2}} -- the IoT architecture (T-arch), the device (T-dev), the network (T-nwk), and the application (T-app).
The lifecycle moment in which the threat takes place can be -- as described in {{sec3-1}} -- during manufacturing (L-make), commissioning process (L-conf), operation (L-oper), software updates (L-update), and decommissioning (L-deconf).



In the following, we list threats and we classify them in {{fig31}} and {{fig32}} according to the two categories above.


## Threat summary {#sec4-1}


~~~~

      +----------+-----------+-----------+---------+
      |T-arch    | T-dev     |  T-nwk    | T-app   |
+-----+----------+-----------+-----------+---------+
|  1  |    y     |     y     |           |         |  
+-----+----------+-----------+-----------+---------+
|  2  |    y     |     y     |           |         |  
+-----+----------+-----------+-----------+---------+
|  3  |    y     |     y     |           |         |  
+-----+----------+-----------+-----------+---------+
|  4  |    y     |           |    y      |    y    |  
+-----+----------+-----------+-----------+---------+
|  5  |     y    |           |    y      |    y    |  
+-----+----------+-----------+-----------+---------+
|  6  |     y    |           |    y      |    y    | 
+-----+----------+-----------+-----------+---------+
|  7  |     y    |           |    y      |    y    | 
+-----+----------+-----------+-----------+---------+
|  8  |     y    |     y     |           |    y    |  
+-----+----------+-----------+-----------+---------+
|  9  |     y    |     y     |           |         |  
+-----+----------+-----------+-----------+---------+
|  10 |    y     |           |    y      |         |  
+-----+----------+-----------+-----------+---------+
|  11 |    y     |    y      |    y      |   y     |  
+-----+----------+-----------+-----------+---------+
|  12 |    y     |     y     |    y      |   y     |  
+-----+----------+-----------+-----------+---------+
|  13 |    y     |     y     |     y     |    y    |  
+-----+----------+-----------+-----------+---------+
|  14 |          |     y     |           |   y     |  
+-----+----------+-----------+-----------+---------+
|  15 |          |     y     |           |    y    |  
+-----+----------+-----------+-----------+---------+
|  16 |     y    |     y     |    y      |    y    | 
+-----+----------+-----------+-----------+---------+
|  17 |     y    |           |           |    y    | 
+-----+----------+-----------+-----------+---------+
|  18 |     y    |           |           |    y    |  
+-----+----------+-----------+-----------+---------+
|  19 |     y    |     y     |     y     |    y    |  
+-----+----------+-----------+-----------+---------+
|  20 |    y     |     y     |           |         |  
+-----+----------+-----------+-----------+---------+
|  21 |    y     |    y      |           |   y     |  
+-----+----------+-----------+-----------+---------+
|  22 |          |     y     |           |         |  
+-----+----------+-----------+-----------+---------+
|  23 |    y     |     y     |     y     |         |  
+-----+----------+-----------+-----------+---------+
|  24 |    y     |           |           |   y     |  
+-----+----------+-----------+-----------+---------+
|  25 |    y     |     y     |           |    y    |  
+-----+----------+-----------+-----------+---------+

~~~~
{: #fig31 title="This tables illustrates which parts of the IoT system are affected by different theats."}


~~~~

      +--------+--------+---------+--------+--------+---------+
      |L-make  | L-conf | L-oper  | L-upd  | L-dec  | L-after |
+-----+--------+--------+---------+--------+--------+---------+
|  1  |    y   |        |   y     |  y     |        |         |  
+-----+--------+--------+---------+--------+--------+---------+
|  2  |    y   |        |   y     |  y     |        |         |  
+-----+--------+--------+---------+--------+--------+---------+
|  3  |    y   |        |   y     |        |        |         |  
+-----+--------+--------+---------+--------+--------+---------+
|  4  |        |    y   |   y     |  y     |        |         |  
+-----+--------+--------+---------+--------+--------+---------+
|  5  |        |    y   |   y     |  y     |        |         |  
+-----+--------+--------+---------+--------+--------+---------+
|  6  |        |    y   |   y     |  y     |        |         |  
+-----+--------+--------+---------+--------+--------+---------+
|  7  |        |    y   |   y     |  y     |        |         |  
+-----+--------+--------+---------+--------+--------+---------+
|  8  |    y   |        |         |  y     |        |         |  
+-----+--------+--------+---------+--------+--------+---------+
|  9  |    y   |        |   y     |  y     |        |         |  
+-----+--------+--------+---------+--------+--------+---------+
|  10 |        |    y   |   y     |  y     |   y    |         |  
+-----+--------+--------+---------+--------+--------+---------+
|  11 |    y   |    y   |   y     |  y     |   y    |         |  
+-----+--------+--------+---------+--------+--------+---------+
|  12 |    y   |    y   |   y     |  y     |   y    |         |
+-----+--------+--------+---------+--------+--------+---------+
|  13 |        |    y   |   y     |  y     |   y    |         |
+-----+--------+--------+---------+--------+--------+---------+
|  14 |        |        |   y     |        |        |         |  
+-----+--------+--------+---------+--------+--------+---------+
|  15 |        |        |   y     |        |        |         |  
+-----+--------+--------+---------+--------+--------+---------+
|  16 |        |    y   |   y     |  y     |   y    |    y    |
+-----+--------+--------+---------+--------+--------+---------+
|  17 |        |    y   |   y     |  y     |   y    |         |  
+-----+--------+--------+---------+--------+--------+---------+
|  18 |    y   |        |         |  y     |        |         |  
+-----+--------+--------+---------+--------+--------+---------+
|  19 |    y   |   y    |   y     |  y     |   y    |         |  
+-----+--------+--------+---------+--------+--------+---------+
|  20 |    y   |        |   y     |  y     |        |         |  
+-----+--------+--------+---------+--------+--------+---------+
|  21 |    y   |        |   y     |  y     |        |         |  
+-----+--------+--------+---------+--------+--------+---------+
|  22 |        |    y   |   y     |  y     |   y    |         |
+-----+--------+--------+---------+--------+--------+---------+
|  23 |        |    y   |   y     |        |        |         |
+-----+--------+--------+---------+--------+--------+---------+
|  24 |        |        |   y     |        |        |    y    |
+-----+--------+--------+---------+--------+--------+---------+
|  25 |        |   y    |   y     |   y    |  y     |         |  
+-----+--------+--------+---------+--------+--------+---------+
~~~~
{: #fig32 title="This tables illustrates in which moment of a thing's lifecycle a threat can take place."}


## Threat description {#sec4-2}

In the following, we describe specific threats. This list is not exhaustive and can be further extended in the future.

1. Cloning of things: During the manufacturing process of a thing, an untrusted factory can easily clone the physical characteristics, firmware/software, or security configuration of the thing. Deployed things might also be compromised and their software reverse engineered allowing for cloning or software modifications. Such a cloned thing may be sold at a cheaper price in the market, and yet can function normally as a genuine thing. For example, two cloned devices can still be associated and work with each other. In the worst-case scenario, a cloned device can be used to control a genuine device or perform an attack. One should note here, that an untrusted factory may also change functionality of the cloned thing, resulting in degraded functionality with respect to the genuine thing (thereby, inflicting potential damage to the reputation of the original thing manufacturer). Moreover, additional functionality can be introduced in the cloned thing, an example of such functionality is a backdoor.

2. Counterfeiting.

3. Malicious substitution of thing: During the installation of a thing, a genuine thing may be substituted with a similar variant (of lower quality) without being detected. The main motivation may be cost savings, where the installation of lower-quality things (for example, non-certified products) may significantly reduce the installation and operational costs. The installers can subsequently resell the genuine things to gain further financial benefits. Another motivation may be to inflict damage to the reputation of a competitor's offerings.

4. Eavesdropping attack: During the commissioning of a thing into a network, it may be susceptible to eavesdropping, especially if operational keying materials, security parameters, or configuration settings, are exchanged in clear using a wireless medium or if used cryptographic algorithms are not suitable for the envisioned lifetime of the device and the system. After obtaining the keying material, the attacker might be able to recover the secret keys established between the communicating entities (e.g., H2T, T2Ts, or Thing to the backend management system), thereby compromising the authenticity and confidentiality of the communication channel, as well as the authenticity of commands and other traffic exchanged over this communication channel. When the network is in operation, T2T communication may be eavesdropped upon if the communication channel is not sufficiently protected or in the event of session key compromise due to a long period of usage without key renewal or updates.

5. Message injection:

6. Message modification:

7. Man-in-the-middle attack: Both the commissioning phase and operational phases may also be vulnerable to man-in-the-middle attacks, e.g., when keying material between communicating entities are exchanged in the clear and the security of the key establishment protocol depends on the tacit assumption that no third party is able to eavesdrop during the execution of this protocol. Additionally, device authentication or device authorization may be non-trivial, or may need support of a human decision process, since things usually do not have a-priori knowledge about each other and cannot always be able to differentiate friends and foes via completely automated mechanisms. Thus, even if the key establishment protocol provides cryptographic device authentication, this knowledge on device identities may still need complementing with a human-assisted authorization step (thereby, presenting a weak link and offering the potential of man-in-the-middle attacks this way).

8. Firmware Replacement attack: When a thing is in operation or maintenance phase, its firmware or software may be updated to allow for new functionality or new features. An attacker may be able to exploit such a firmware upgrade by replacing the thing's software with malicious software, thereby influencing the operational behavior of the thing. For example, an attacker could add a piece of malicious code to the firmware that will cause it to periodically report the energy usage of the lamp to a data repository for analysis. Similarly, devices whose software has not been properly maintained and updated might contain vulnerabilities that might be exploited by attackers.

9. Extraction of private information: in the ambient environment the things (such as sensors, actuators, etc.) are usually physically unprotected and could easily be captured by an attacker. Such an attacker may then attempt to extract private information such as keys (e.g., device's key, private-key, group key), sensed data (e.g., healthcare status of a user), configuration parameters (e.g., the WiFi key), or proprietary algorithms (e.g., algorithm performing some data analytic task) from this thing. Compromise of a thing's unique key compromises communication channels of this particular thing and also compromise all data communicated over this channel.  

10. Routing attack: As highlighted in {{ID-Daniel}}, routing information in IoT can be spoofed, altered, or replayed, in order to create routing loops, attract/repel network traffic, extend/shorten source routes, etc. Other relevant routing attacks include 1) Sinkhole attack (or blackhole attack), where an attacker declares himself to have a high-quality route/path to the base station, thus allowing him to do manipulate all packets passing through it. 2) Selective forwarding, where an attacker may selectively forward packets or simply drop a packet. 3) Wormhole attack, where an attacker may record packets at one location in the network and tunnel them to another location, thereby influencing perceived network behavior and potentially distorting statistics, thus greatly impacting the functionality of routing. 4) Sybil attack, whereby an attacker presents multiple identities to other things in the network.

11. Timing attacks.

12. Privacy threat - identification: The tracking of a thing's location and usage may pose a privacy risk to its users. An attacker can infer information based on the information gathered about individual things, thus deducing behavioral patterns of the user of interest to him. Such information can subsequently be sold to interested parties for marketing purposes and targeted advertising.

13. Privacy threat - localization:

14. Privacy threat - profiling:

15. Privacy threat - interaction:

16. Privacy threat - lifecycle transitions:

17. Privacy threat - inventory attacks:

18. Privacy threat - linkage:      

19. Data leakage - cryptographic keys: 

20. Data leakage - source code:

21. Data leakage - propietary algorithms:  

22. Denial-of-Service attack on device: Typically, things have tight memory and limited computation, they are thus vulnerable to resource exhaustion attack. Attackers can continuously send requests to be processed by specific things so as to deplete their resources. This is especially dangerous in the IoTs since an attacker might be located in the backend and target resource-constrained devices in an Low-Latency Network (LLN). Additionally, DoS attack can be launched by physically jamming the communication channel, thus breaking down the T2T communication channel. Network availability can also be disrupted by flooding the network with a large number of packets. On the other hand, things compromised by attackers can be used to disrupt the operation of other networks or systems by means of a Distributed DoS attack.

23. Denial-of-Service attack on network:

24. Store and decrypt attack (Quantum-resistance):  

25. Software vulnerabilities:

 

The following table summarizes the above generic security threats and the potential point of vulnerabilities at different layers of the communication stack. We also include related RFCs and ongoing standardization efforts that include a threat model that might apply to the IoTs.


# Security Mitigations {#sec5}

Deal with the security threats detailed in {{sec4}} requires a number of security mitigations as the ones detailed in Internet Draft {{ID-Moore}}.
In this section, we further detail some of them that will be used later:

1. Capability to perform an authenticated software update.

2. Capability to perform server authentication.

3. Capability to perform client authentication.

4. Capability to encrypt communications.

5. Capability to encrypt communications.

6. Application isololation.

7. Management gateway.

8. Two factor authentication of application requests.

9. Physical security of the device.

10. Usage of application layer proxy.

11. Regular update of authentication credentials.


# Integrating security processess in the IoT lifecycle {#sec6}

[ToDo: This section should describe how an IoT system should be designed/operated. The text below is from the old draft and it should be further improved.]

Dealing with above threats and finding suitable security mitigations is challenging: there are very sophisticated threats that a very powerful attacker could use; also, new threats and exploits appear in a daily basis. Therefore, the existence of proper secure product creation processes that allow managing and minimizing risks during the lifecycle of the IoT devices is at least as important as being aware of the threats. A non-exhaustive list of relevant processes include: 

1. A Business Impact Analysis (BIA) assesses the consequences of loss of basic security attributes, namely, confidentiality, integrity and availability in an IoT system. These consequences might include impact on data lost, sales lost, increased expenses, regulatory fines, customer dissatisfaction, etc. Performing a business impact analysis allow determining the business relevance of having a proper security design placing security in the focus.

2. A Risk Assessment (RA) analyzes security threats to the IoT system, considering their likelihood and impact, and deriving for each of them a risk level. Risks classified as moderate or high must be mitigated, i.e., security architecture should be able to deal with that threat bringing the risk to a low level. Note that threats are usually classified according to their goal: confidentiality, integrity, and availability. For instance, a specific threat to recover a symmetric-key used in the system relates to confidentiality.

3. A privacy impact assessment (PIA) aims at assessing Personal Identifiable Information (PII) that is collected, processed, or used in the IoT system. By doing so, the goals is to fulfill applicable legal requirements, determine risks and effects of the manipulation of PII, and evaluate proposed protections. 

4. Procedures for vulnerability assessment (VA) aim at assessing whether the IoT system is secure or any vulnerabilities are present. This can be due to changes in the context information such as people involved in the IoT system or new software vulnerabilities discovered. 

5. Procedures for incident reporting (IR) and mitigation refer to the methodologies that allow becoming aware of any security issues that affect an IoT systeoT

Traditionally, BIA, RA, and PIA are usually to be realized during the creation of a new IoT system, introduction of new technologies in the IoT system, or deployment of significant system upgrades. In general, it is recommended to re-assess them on a regular basis taking into account new use cases or threats. VA is also often realized before deployment, e.g., by performing a penetration test before the new product release is deployed. 
Incident reporting is done during operation of the IoT system, when a vulnerability is discovered.

All these processes, namely BIA, RA, PIA, VA, and IR, are a must in the design of any IoT system. If they are not performed, the risk of not having a secure enough system is very high.
However, even if these procedures are in place, the IoT systems can still have an unsatisfactory security level due to multiple reasons:

1. First example: a risk assessment is performed, but the product is deployed in an environment in which the threats and boundaries are different. This leads to the situation in which an IoT system was properly designed, but it is being used in an environment with different security needs.

2. Second example: a risk assessment is performed during the design phase, then also a vulnerability assessment is executed including a penetration test and the product is released to the customers. Some time later, new vulnerabilities appear in a new devices that was installed in the same IoT network. This leads to the situation in which an IoT system was properly designed and tested for vulnerabilities, but it becomes later unsecured due to changes in the environment.

Thus, the authors believe that the above procedures should be fully integrated in the lifecycle of a smart object as showed in {{fig4}}. 
BIA still takes place during the design phase of the new IoT device.
However, RA and PIA are moved now to the installation and commissioning phases of the devices since it is then when the actual environment in which smart objects are deployed is really known.
The VA keeps running during the operation of the IoT system.
Information gathered during VA can feed the RA and PIA processes to update security settings.
Similarly, security incidents found out during continuous VA lead to IR.
When smart objects are sold or the system updated, this triggers again RA and PIA.

~~~~
 _Manufactured           _SW update          _Decommissioned
/                       /                   /
|   _Installed          |   _ Application   |   _Removed &
|  /                    |  / reconfigured   |  /  replaced
|  |   _Commissioned    |  |                |  |
|  |  /                 |  |                |  |   _Reownership &
|  |  |    _Application |  |   _Application |  |  / recommissioned
|  |  |   /   running   |  |  / running     |  |  |
|  |  |   |             |  |  |             |  |  |             \\
+##+##+###+#############+##+##+#############+##+##+##############>>>
 \   \/  \______________________________________/ /   time //
  \   \                        \                 /
 BIA   \               Continuous VA--->IR      /
        RA and PIA <__________|           RA and PIA  

~~~~
{: #fig4 title="Security processes integrated in the lifecycle of a thing in the Internet of Things."}
 
In Section {{sec7}} we describe the Protocol for Automatic Security Configuration (PACS) that addresses how to solve the integration of the RA and PIA processes in the installation and commissioning phase.
Then, in Section {{sec8}} we describe the Protocol for Automatic Vulnerability Assessment that addresses how to perform continuous vulnerability assessment. 

# Protocol for Automatic Security Configuration (PASC) {#sec7}

Traditional IoT systems are created from scratch and require a suitable security design following the phases descrbed in Section {{sec6}}.
Many generic IoT platforms are emerging that can be instantiated in different products that can be deployed in many different environments.
Thus, we describe the Protocol for Automatic Security Configuration (PASC) that enables automatic security configuration by shifting methodologies for risk management from the tailored product design and implementation phases to the onboarding phase.

~~~~
  _________________________________________________
|                                                    | 
| Thing1       Thing2         GW         Router      |   M1     Platform
|                                                    |     
|    ++++++++++ m1 +++++++++>                            
|                                                    |     
| 			    +++++++++++++ m2 ++++++++++++>
|                                                    |     
|                           <++++++++++++ m3 ++++++++++++
|                                                    |     
| 			RA and PIA
|                                                    |     
|                 	    ++++++++++++++++++++ m4 +++++++++++++++++++>
|                                                    |     
| 		            <+++++++++++++++++++ m5 +++++++++++++++++++
|                                                    |     
|      <+++++++++ m6 +++++++++
|                                                    |     
|              <++++ m7 ++++++
|                                                    |     
| 			    ++++ m8 ++++>
|                                                    |     
|              IoT Security Domain                   |     
  _________________________________________________
~~~~
{: #fig5 title="Protocol for Automatic Security Configuration."}

Figure {{fig5}} depicts the main parties involved in the protocol: two smart objects denoted as 'Thing1' and 'Thing2', a  device controlling the IoT domain called 'GW', a router towards the IoT domain, the manufacturer server of 'Thing1' denoted as 'M1' and the server of the platform denoted as 'platform'.

The main protocol steps of PASC are as follows:
When 'Thing1' is introduced in the IoT domain, 'Thing1' first publishes its profile to the available 'GW' in message 'm1'.
'GW' then gathers information from 'm1' regarding 'Thing1' in messages 'm2' and 'm3'.
At this stage, 'GW' has information about the available smart objects in the IoT domain and also can gather input from the user on the usage and expected interactions of the smart object with other devices in the deployment environment.
Thus, 'GW' can perform an automated risk assessment of the IoT device in the security domain determining potential threats on the device and on the system, and assigning a security profile containing security mitigations to the identified threats.
In messages 'm4' and 'm5' the GW can gather security updates from 'platform' that might be required for the new situation after the introduction of 'Thing1' in the IoT security domain.
Finally, messages 'm6', 'm7' and 'm8' are used to deploy updated security profiles to the new smart object 'Thing1' and potentially also to other devices already present in the deployment environment, namely, the 'router' and other smart objects (e.g., 'Thing2').

In practice, PACS can be created by extending and combining a number of protocols.
Messages 'm1', 'm2', and 'm3' resemble steps of the Manufacturer Usage Descriptor (MUD) protocol.
After these messages, RA and PIA can be executed given available information on the expected usage of the devices and input from the user.
Messages 'm4' and 'm5' require standardization since they resemble the access for various software updates that might be required to fullfil security needs.
Configuration messages 'm6' and 'm7' might be instantiated by a combination and extension of ACE and MUD protocol.
Message 'm8' requires standarization to automatically configure router and firewall rules.

# Protocol for Automatic Vulnerability Assessment (PAVA) {#sec8}

Today vulnerability assessment is either not performed at all or it is only performed when products are designed.
The Protocol for Automatic Vulnerability Assessment (PAVA) overcomes this.
PAVA relies on each smart object (e.g., Thing1) sending standarized reports of potential vulnerabilities to 'GW', the device managing the IoT security domain.
Such reports would build on RFC 5424, RFC 5425 and RFC 5426. Reports and methodology can also benefit from RFC6872. 
The 'GW' then analyzes the logs and takes a decision regarding the existence of a vulnerability, its origin and its impact.
Output of this decision is threefold:  

1. incident report towards the user
2. update of security profiles in smart objects of the IoT security domain.
3. automatic incident reporting towards the manufacturer
4. automatic incident reporting towards the platform provider

# Benefits of integrating security processes in the IoT lifecycle through PASC and PAVA {#sec9}


Section {{sec8}} describes how manufactures and users will benefit from PASC and PAVA when creating, making or using IoT systems.

Users benefit since security configuration is done in an automatic way -- they need to do nothing. 
Security settings are automatically configured according to the specific deployment environment that a user only needs to confirm.

Manufacturers benefit since they do not need to decide which security mitigations they require on a product. Instead of it, they just need to describe the expected usage of the product that is then confirmed by the user. Security profiles are then automatically deployed on the smart object.

# Security Profiles {#sec10}

We expect the various types of IoT deployments to be widespread and to penetrate almost all areas of our personal and professional life including building automation systems, healthcare, smart cities, logistics, etc. For each of these environments, properties such as device capabilities, network infrastructure, or available security services can be completely different. That makes it difficult to define and deploy complete security configurations for each generic use case. Furthermore, each of those applications is featured by a different number of actors deployed in very different environments and with very different purposes. Consequently, when a Business Impact Analysis or Risk Assessment is performed, not only the types of threats will be different, but also their likelihood and potential impact. This determines that different applications tend to require different or complementary types of security mechanisms mitigating the identified risks. 

This section describes some exemplary Security Profiles that can be automatically created by means of PASC fitting the security needs of applications with the same characteristics and requirements. These security profiles are beneficial since they make the underlying threats transparent, allow for interoperability while preserving security and prevent possible security misconfiguration.
It is expected that the security profiles defined in this section need to be extended and adapted based on the individual risk profiles of each environment as described in {{sec6}} of this document.

Each security profile includes:

1. a short descriptive name,
2. an exemplary application that might use the security profile,
3. the main security threats applicable to the profile,
4. the security mitigations required by the profile,
5. specific configuration parameters for the protocols and actors involved in the application.

## Classes of IoT Systems {#sec10-1}

Based on the PASC the IoT devices can be grouped by function, by required access and by deployment scope into individual IoT device classes. While grouping things into individual device classes based on function and required access is a universal part of each PASC independent of the desired deployment environment, the deployment scope MUST be considered as well based on the different threats in various deployment environments. For example, the same thing deployed in smart homes or in smart cities will have the same PASC entries for function and required access, however, the deployment scope and the inherited security threats from the different environments will require different PASC and PAVA for the two deployment scenarios. 
 
Each one of these IoT device classes will represent an isolated segment in itself and will receive an individual and continuous PAVA during the lifetime of the things in the device class. In order to connect with things in different segments, the management gateway MUST be used.
 
The goal of creating device classes for IoT devices is to enable the near-automatic management of a clear separation of security threats and risk assessments by enforcing device segmentation for each class of devices. This segmentation process SHOULD therefore be automated, but the automation part itself is out of scope for this document. The segments must be pre-defined before the PASC is created. If the PASC requires a new segment to introduce a thing into a certain environment, the segment MUST be defined first. Protocols like MUD SHOULD be used as a valuable source of information during the classification and provisioning process in PASC. 
 
We consider four generic security profiles applicable to four exemplary application areas as summarized in the table below:

~~~~
           +---------------------------------------------------------+
           | Exemplary       |                                       |
           | IoT Application |          Description                  |
+----------+---------------------------------------------------------+
|SecProf_1 |Home usage       |Enables operation between home things  |
|          |                 |without interaction with central device|
+----------+-----------------+---------------------------------------+
|SecProf_2 |Managed Home     |Enables operation between home things. |
|          | usage           |Interaction with a central and local   |
|          |                 |device is possible                     |
+----------+-----------------+---------------------------------------+
|SecProf_3 |Industrial usage |Enables operation between things.      |
|          |                 |Relies on central (local or backend)   |
|          |                 |device for security                    |
+----------+-----------------+---------------------------------------+
|SecProf_4 |Advanced         |Enables ad-hoc operation between things|
|          |Industrial usage |and relies on central device or        |
|          |                 |on a collection of control devices     |
+----------+-----------------+---------------------------------------+
~~~~
{: #fig6 title="Security profiles and application areas."}


The currently existing IoT products can be loosely categorized in 4 different profiles, where SecProf_1 would be the lowest category of security profiles and SecProf_4 would be the highest category of security profiles. It is considered best practice in the security world to allow higher security profiles to connect to lower security profiles, but to never let lower security profiles connect to higher security profiles. The same precautions SHOULD be used for the IoT Security Profiles defined below. The separation between the Security Profiles described in {{fig6}} is not a strict physical separation, but a logical one. A home IoT device and its management software may include components that fall into the SecProf_1 as well as SecProf_2 category. Within every security profile exists a graduation of different security levels. The exact category within a security profile will be determined with a risk analysis of the thing and its functionality and MUST be reviewed on a regular basis. This is because each security profile will contain devices with a high lifecycle variation. Certain IoT devices are meant to be used for a few hours only, while others are expected to last decades. Given the technological progress, the security of a thing may degenerate over time within the same security profile. 

The best mitigation strategy against unknown future threats are software updates, for example, to replace a broken hash algorithm with a more secure one as long as the thing can handle the computational load of the new hash algorithm. 


## Security Profile 1: Home usage {#sec10-2}

SecProf_1 categorizes unmanaged IoT devices mostly found in private homes. The things in this Security Profile are single-purpose devices, used either on a daily or less frequent basis. The types of threats those things will face are usually minimal risk. The likelihood of misuse entirely depends on physical proximity to the thing. 

Given the example of an internet-connected button for the delivery of fresh bananas, it would require physical interaction (“button press”) and SHOULD make use of technologies like fingerprint sensors to limit the order ability to a small set of authorized individuals. A misuse would at maximum lead to an unwanted delivery of fruits, and a supermarket can easily enforce a maximum amount of fruits an individual household would order before assuming malicious intent.

This Security Profile requires unidirectional communication from the thing to a specific service. Additional services like order confirmation will be handled via separate channels. Mitigations for security threats identified in the PASC MUST contain encryption on the transport layer of the application, a strict isolation from other nodes in a shared network and a proper physical placement of the thing. Additionally, a strong identification mechanism, like X.509 Certificates, MUST be used to identify the exact thing that talks to the specific service. 


~~~~
+----------------------------------------------+
| Threats  |  Mitigations                      |
+----------+-----------------------------------+
|   T4     |    M4              
+----------+-----------------------------------+
|   T5     |    M2, M3, M8          
+----------+-----------------------------------+
|   T6     |    M2, M3, M8          
+----------+-----------------------------------+

~~~~

{: #fig61 title="Threats and mitigation strategies for Security Profile 1."}



## Security Profile 2: Managed Home usage {#sec10-3}

SecProf_2 categorizes managed IoT devices mostly found in private homes. The things in this Security Profile are more complex, often multi-purpose devices, and meant to be used on a daily basis. The types of threats those things will face are usually in the medium to high risk category. Misuse of the thing depends on the security of the managed service bundled to the thing. 

Given the example of an smart door lock, the PASC contains physical and logical security risks. The physical security of the lock MUST be on the same standard that non-smart door locks provide. For the logical security of the door lock, physical presence close to the smart door lock MUST be enforced for the unlocking functionality, while the locking functionality might also be used remotely. Key escrow must be possible via a secure procedure for emergency services like Police or the Fire Brigade. 

This Security Profile requires bidirectional communication from the thing to a specific management gateway. All communication with specific services as well as other smart objects MUST go through the management gateway. The management gateway may act as an application layer proxy when it is used as a relay to enable communication between smart objects and nodes within a single domain or local network. Mitigations for security threats identified in the PASC MUST contain encryption on the transport layer of the application and a strict isolation from other nodes except the management gateway in a shared network. Additionally, a strong identification and authentication mechanism, like X.509 Certificates, MUST be used to identify and authenticate the thing when it talks to the management gateway. The credentials used for authentication and authorization MUST be refreshed on a regular basis.  

## Security Profile 3: Industrial usage {#sec10-4}

SecProf_3 categorizes unmanaged or partially managed IoT devices found in industrial or commercial environments. The things in this Security Profile are single-purpose devices, used by a number of unidentified people. The types of threats those things will face are in the minimal or medium risk category. Misuse could lead to a certain inconvenience, but would not put the operation of the industrial or commercial environment at risk.

Given the example of a HVAC system in a commercial office building, the components of such a system would include a central HVAC management service for the building, temperature sensors spread across the whole building and heating and cooling devices at certain places across the building. Communication from the smart objects spread across the building would be unidirectional depending on their functionality. The temperature sensors would unidirectional communicate frequently with the HVAC central management service. The HVAC central management service would unidirectional communicate as needed with the heating and cooling devices to regulate the temperature across the building. 

This Security Profile requires a mix of unidirectional and bidirectional communication between the things and a specific service. Mitigations for security threats identified in the PASC MUST contain encryption on the transport layer of the application, a strict isolation from other nodes in a shared network for the smart things and a strong identification mechanism, like X.509 Certificates, MUST be used to identify the exact thing that talks to the central management service. Mitigations for security threats identified in the PASC for central management service which requires bidirectional communication with multiple things MUST contain encryption on the transport layer of the application and MUST use a strong identification and authorization mechanism, like X.509 Certificates, to identify and authenticate the central management service when it talks to the individual smart objects. The central management service may act as an application layer proxy when it is used as a relay to enable communication between smart objects and nodes within a single domain or local network. The credentials used for authentication and authorization MUST be refreshed on a regular basis.

## Security Profile 4: Managed Industrial usage {#sec10-5}

SecProf_4 categorizes fully managed IoT devices found in industrial or commercial environments. The things in this Security Profile are multi-purpose devices, used by a number of authenticated and authorized people. The types of threats those things will face are in the high risk category. Misuse could lead to a partial or full compromise of the industrial or commercial environment. 

Given the example of a physical security system with managed access in a commercial datacenter, the components of such a system would include components like cameras, infrared sensors, access control systems and fire safety. All components have either unidirectional or bidirectional connectivity to a local or remote management gateway. All communication with specific services as well as other smart objects MUST go through the management gateway. The management gateway controls the functionality of each smart component within the integrated physical security system. The management gateway may act as an application layer proxy when it is used as a relay to enable communication between the individual components of the integrated physical security system and external nodes within a single domain or local and remote networks. 

Mitigations for security threats identified in the PASC MUST contain encryption on the transport layer of the application and a strict isolation from other nodes except the management gateway in a shared network. Additionally, a strong identification and authentication mechanism, like X.509 Certificates, MUST be used to identify and authenticate all IoT components for the communication with the management gateway. The credentials used for authentication and authorization MUST be refreshed on a regular basis.   

# Conclusions {#sec11}

ToDo

# Security Considerations {#sec12}

This document reflects upon the requirements and challenges of the security
architectural framework for the Internet of Things.

# IANA Considerations {#sec13}

This document contains no request to IANA.

# Acknowledgments {#sec14}


 
 














